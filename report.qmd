---
title: "Does the age difference of actors in movies decrease as the release date becomes more modern?"
subtitle: "THAN: Report"
format: html
editor: visual
execute:
  echo: true
---

## Data Introduction:

This data comes from the Tidy Tuesday repositories on GitHub via the site "Data is Plural."

The dataset, *Hollywood Age Gap*, was compiled by Lynn Fisher andexplores the age difference between actors playing couples in Hollywood movies which demonstrates the male-female power dynamic in the movie industry.

*Hollywood Age Gap* has information from upwards of 630 movies, sampled from films from 1935 to 2022, the dataset was most recently updated on February 25th, 2023.

The dataset, while mostly compiled by Lynn Fisher, is open source and in turn anyone can submit data to the dataset for consideration contingent on three rules:

1.  The actors are atleast 17 years old
2.  The actors are actually love interests in the film
3.  The characters can not be animated

Observations of the data set list the movie name, director, release year, and then the age difference before having columns for what number couple each one is (only matters if there are multiple in the movie), their names, their characters' names, their birth dates, and then their ages.

## Research Question:

**Does the age difference between actors in movie relationships decrease as the release date becomes more modern?**

Our research will attempt to determine whether the uncomfortable age gaps between male and female romantic interests in movies has been waning over time. This will tell us if criticism within the industry and from viewers has actually been effective in making a change on this issue.

In addition we will explore whether the male or female member of the couples tends to be older and whether the proportion of films with large age gaps has shifted over time. 

Some other things to explore could be the trends of specific actors/actresses that may have experienced both sides of the age gaps, as well as how this trend exists in movies with multiple couples. 

## Methodology

**We predict that overtime the mean age gap between couples will lessen due to the criticism of these age gaps within the film industry and that overtime the proportion of films with large age gaps will also decrease.**

Since same-sex couples have only begun to be shown in film in the last couple decades, we plan to filter the data set so that it only contains information about movies with heterosexual couples. We will briefly analyze data for same-sex couples towards the end of this report.

We will then plot the age difference in movies over time via a scatter-plot with all of the movies. We can then draw a best fit line to see the trend of age-gaps as time has elapsed. We will also color the age differences based on whether the man or woman in the relationship was older. 

We will then look at individual 25 year eras of film production, calculating the true mean age gap found in films produced during the years pre-1950, 1950-1975, 1975-2000, and post-2000. By comparing the confidence intervals produced either by bootstrapping or CLT (based on whether data fits CLT requirements), we can find a better understanding of how age gaps changed between each era. 

We will also fit a linear regression model to the data, to see how well the year a film was released can predict the age gap found in the film. We will look at the r-squared of this model to show its strength and analyze the results significance in regards to our hypothesis. 

Further, we can preform a hypothesis test to determine whether our hypothesis that age gaps are less today than they were in the past is accurate, finding a p-value to assess our null hypothesis that the mean age gaps today are the same as those in the past. 

Lastly, we will investigate whether the proportion of films with large age gaps has decreased over time by looking at the difference in proportions between the 25 year eras.

##  Results
### Loading Data and Mutation
```{r}
#| label: load-data-3

library(tidyverse)
library(tidymodels)
agegaps <- read.csv(file = 'data/age_gaps.csv')
glimpse(agegaps)

```

```{r}
#| label: mutate-data-category
agegaps <- agegaps |>
  mutate(age_gap_cat = if_else(age_difference <= 15, 
                               "Age Gap of 15 Years or Less",
                               "Age Gap Over 15 Years")) |>
  mutate(age_gap_cat = fct_relevel(age_gap_cat, 
                                   c("Age Gap Over 15 Years",
                                     "Age Gap of 15 Years or Less"))) |>
  arrange(age_gap_cat)
```

```{r}
#| label: mutate-data-decades
agegaps <- agegaps |>
  mutate(decades = if_else(release_year >= 1931 & release_year <= 1940, 
                                 "1930s",
                          if_else(release_year >= 1941 & release_year <= 1950, 
                                  "1940s",
                          if_else(release_year >= 1951 & release_year <= 1960, 
                                  "1950s",
                          if_else(release_year >= 1961 & release_year <= 1970, 
                                  "1960s",
                          if_else(release_year >= 1971 & release_year <= 1980, 
                                  "1970s",
                          if_else(release_year >= 1981 & release_year <= 1990, 
                                  "1980s",
                          if_else(release_year >= 1991 & release_year <= 2000, 
                                  "1990s",
                          if_else(release_year >= 2001 & release_year <= 2010, 
                                  "2000s",
                          if_else(release_year >= 2011 & release_year <= 2020, 
                                  "2010s", "2020s"))))))))))
```

```{r}
#| label: mutate-data-olderpartner
agegaps <- agegaps |>
  mutate(older_partner = if_else(actor_1_age > actor_2_age & 
                                   character_1_gender == "man", 
                                 "Male", "Female"))
```

```{r}
#| label: mutate-data-eras

agegaps <- agegaps |>
  mutate(era = if_else(release_year >= 1930 & release_year < 1950, 
                                 "pre-1950s",
                          if_else(release_year >= 1951 & release_year < 1975, 
                                  "1950 to 1975",
                          if_else(release_year >= 1975 & release_year < 2000, 
                                  "1975 to 2000", "post-2000")))) |>
  mutate(era = fct_relevel(era, c("pre-1950s",
                                          "1950 to 1975",
                                          "1975 to 2000",
                                          "post-2000"))) |>
  arrange(era)
```

```{r}
#|label: filter-hetero-samesex

agegaps_hetero <- agegaps |>
  filter(character_1_gender != character_2_gender)

agegaps_samesex <- agegaps |>
  filter(character_1_gender == character_2_gender)
```

```{r}
#|label: filter-hetero-eras

agegaps_1925 <- agegaps |>
  filter(era == "pre-1950s")

agegaps_1950 <- agegaps |>
  filter(era == "1950 to 1975")

agegaps_1975 <- agegaps |>
  filter(era == "1975 to 2000")

agegaps_2000 <- agegaps |>
  filter(era == "post-2000")
```

### Heterosexual Couples

```{r}
#| label: agegap-hetero

agegaps_hetero |>
  filter(age_difference != 0) |>
  ggplot(aes(x = release_year, y = age_difference, color = older_partner)) +
  geom_point(alpha = .5) +
  geom_smooth(method = lm, se = FALSE, color = "#740C9A") +
  scale_color_manual(values = c("Male" = "#21B0FF", "Female" = "#FF218C")) +
  geom_smooth(method = lm, se = FALSE) +
  labs(title = "Age Gaps in Hollywood Films Over the Years", 
       x = "Movie Release Year",
       y = "Age Gap In Years",
       color = "Older Partner Gender")
```

The scatter plot above visualizes the age difference between actors in movie relationships over time. The observations are colored based on the gender of the older partner. The purple best fit line shows the trend of age gaps regardless of gender.

#### Hypothesis Testing for Difference in Means

From the plot we observe that in cases where the older partner is female, the age difference tends to be less than the age difference for couples where the older partner is male. This is investigated in the following code chunk through hypothesis testing.

Null Hypothesis: the true mean age gap for couples where the older partner is male is the same as the true mean age gap for couples where the older partner is female.

$H_o: \mu_m - \mu_f = 0$

Alternative Hypothesis: the true mean age gap for couples where the older partner is male is greater than the true mean age gap for couples where the older partner is female.

$H_o: \mu_m - \mu_f > 0$

```{r}
#| label: point-est-hetero
agegaps_hetero |>
  group_by(older_partner) |>
  summarize(mean_age = mean(age_difference))
```

$\bar{x}_m - \bar{x}_f = 11.7 - 4.73 = 6.97$

```{r}
#| label: null-dist-hetero
set.seed(0)
null_dist_hetero <- agegaps_hetero |>
  specify(response = age_difference, explanatory = older_partner) |>
  hypothesize(null = "independence") |>
  generate(reps = 1000, type = "permute") |>
  calculate(stat = "diff in means", order = c("Female", "Male"))
```

```{r}
#| label: p-value-hetero

null_dist_hetero |>
  get_p_value(obs_stat = 6.97, direction = "greater")
```

With a $p-value < 0.001 > \alpha = 0.05$ we *decide* to reject the null hypothesis that the true mean age gap for couples where the older partner is male is the same as the true mean age gap for couples where the older partner is female and *conclude* that there is strong evidence to conclude the alternative hypothesis that the true mean age gap for couples where the older partner is male is greater than the true mean age gap for couples where the older partner is female.

#### Bootstrapping and CLT of Mean Age Gaps

From the plot we also observe that all three best fit lines are trending negatively, indicating a decrease in the age gaps over time. This observation will be explored further in the next section through the use of bootstrapping and CLT (based on sample size) to find the true mean of different eras in time. 

##### pre-1950

```{r}
#label: mean-1925
agegaps_1925 |> 
  summarize(mean_age = mean(age_difference))
```

```{r}
#label: boot-1925
set.seed(1)

boot_1925 <- agegaps_1925 |>
  specify(response = age_difference) |>
  generate(reps = 1000, type = "bootstrap") |>
  calculate(stat = "mean")

boot_1925 |>
  summarize(lower = quantile(stat, 0.025),
            upper = quantile(stat, 0.975))
```

We can say with 95% confidence that the true mean age gap in pre-1950 films was between 12.9 and 21.1 years.

##### 1950-1975

agegaps_1950 meets the independence and sample size requirements for CLT:

Independence - agegaps is a random sample of all hollywood movies

Sample Size - 87 greater than 30

```{r}
#label: mean-1950
 agegaps_1950 |> 
  summarize(mean_age = mean(age_difference))
```

```{r}
#label: CLT-1950
set.seed(2)

est_mu_1950 <- 14.35632
est_sigma_1950 <- sd(agegaps_1950$age_difference , na.rm = T) / sqrt(87)

qnorm(c(0.025, 0.975), est_mu_1950, est_sigma_1950)
```

We can say with 95% confidence that the true mean age gap in films released between 1950 and 1975 was between 12.3 and 16.4 years.

##### 1975-2000

agegaps_1975 meets the independence and sample size requirements for CLT:

Independence - agegaps is a random sample of all hollywood movies

Sample Size - 283 greater than 30

```{r}
#label: mean-1975
 agegaps_1975 |> 
  summarize(mean_age = mean(age_difference))
```

```{r}
#label: CLT-1950
set.seed(3)

est_mu_1975 <- 11.37809
est_sigma_1975 <- sd(agegaps_1975$age_difference , na.rm = T) / sqrt(283)

qnorm(c(0.025, 0.975), est_mu_1950, est_sigma_1975)
```

We can say with 95% confidence that the true mean age gap in films released between 1975 and 2000 was between 13.3 and 15.4 years.

##### post-2000

agegaps_2000 meets the independence and sample size requirements for CLT:

Independence - agegaps is a random sample of all hollywood movies

Sample Size - 766 greater than 30

```{r}
#label: mean-1975
 agegaps_2000 |> 
  summarize(mean_age = mean(age_difference))
```

```{r}
#label: CLT-1950
set.seed(3)

est_mu_2000 <- 9.460836
est_sigma_2000 <- sd(agegaps_2000$age_difference , na.rm = T) / sqrt(766)

qnorm(c(0.025, 0.975), est_mu_2000, est_sigma_2000)
```

We can say with 95% confidence that the true mean age gap in films released after 2000 was between 8.9 and 10.0 years.

##### Analysis of Confidence Intervals

We can say with 95% confidence that the true mean age gaps in...
  pre-1950 films was between 12.9 and 21.1 years
  films released between 1950 and 1975 was between 12.3 and 16.4 years.
  films released between 1975 and 2000 was between 13.3 and 15.4 years.
  films released after 2000 was between 8.9 and 10.0 years.
  
We can observe that over time, the upper bound of the interval has consistently decreased, and the lower bound (besides in the 1975-2000 era) has also decreased, indicating a decrease in the true mean of age gaps over time. This is consistent with what we observed in the scatterplot of age gaps in heterosexual movie couples.

#### Linear Regression Model
```{r}
#| label: lin-reg-hetero
gap_fit <- linear_reg() |>
  set_engine("lm") |>
  fit(age_difference ~ release_year, data = agegaps_hetero)

glance(gap_fit)$adj.r.squared
gap_fit
```
$\widehat{Age Difference} = 231.0808 - 0.1103 * release\_year$

Our linear regression model with release year explains roughly 4.5% variation of the variation in age gaps. This shows that there is not a direct correlation between age gap and the year a film was released but does indicate a negative correlation between age difference and year, supporting our hypothesis that the age difference between actors in movie relationships decreases as the release date becomes more modern.

#### Proportion of Large Age Gaps to Small Age Gaps

The following section will investigate our second question, *has the proportion of films with large age gaps decreased over time?* 

```{r}
#| label: gap-size-decades
agegaps_hetero |>
  ggplot(aes(x = decades, fill = age_gap_cat)) +
  geom_bar(position = "fill", color = "black") +
  scale_fill_manual("Age Gap Category", values = c("Age Gap Over 15 Years" = "#EB5F5E",
                                         "Age Gap of 15 Years or Less" = "#BC5090")) +
  labs(title = "The Decrease of Age Gaps of More Than 15 Years Over Time",
       x = "Decade of Film Release",
       y = "Proportion of Films")
```

The bar chart above groups movie observations into the decade that they were released. The plot shows that as over time the proportion of films containing age gaps of over 15 years decreases. 

In the 1940s, over 80% of films had a large age gap of over 15 years. It may be beneficial to note that World War II occurred during most of this decade. This may have caused this period of age gaps of over 15 years because the younger men were off fighting in war rather than acting. Additionally, it is important to recognize how there are not many data points for the 1930s decade as movies were just becoming more prevalent in society during this time period. Now, in the 2020s around only 30% of films contain a couple with an age gap of over 15 years.

```{r}
#| label: gap-size-era

agegaps_hetero |>
  ggplot(aes(x = era, fill = age_gap_cat)) +
  geom_bar(position = "fill", color = "black") +
  scale_fill_manual("Age Gap Category", values = c("Age Gap Over 15 Years" = "#EB5F5E",
                                         "Age Gap of 15 Years or Less" = "#BC5090")) +
  labs(title = "The Decrease of Age Gaps of More Than 15 Years Over 25 Year Periods",
       x = "25 Year Film Release Era",
       y = "Proportion of Films")
```

The bar chart above groups movie observations into the era that they were released, as was done in the section above utilizing confidence intervals. The plot shows that as over time the proportion of films containing age gaps of over 15 years decreases.

The plot visualizes that as over each 25 year period, the proportion of films containing age gaps of over 15 years decreases. From pre-1950, with over 50% of films having large age gaps of over 15 years to 2000-2025 where less than 25% of films contain a couple with an age gap of over 15 years. 

##### Proportion Hypothesis Testing
The code chunks below will investigate a hypothesis test for whether this observation of a difference in proportions is accurate.

Response Variable - age_gap_cat

Categorical Variable - era

Success - “Age Gap Over 15 Years”

For each evaluation, the null hypothesis is that the proportion of large to small age gaps is the same in the first era being evaluated as it is in the second. The alternative hypothesis is that the proportion of large to small age gaps is larger in the first era being evaluated than it is in the second. 

$H_o: \pi_1 - \pi_2 = 0$

$H_a: \pi_1 - \pi_2 \neq 0$

```{r}
#| label: gap-size-proportion

stat_hetero <- agegaps_hetero |>
  group_by(era, age_gap_cat) |>
  summarize(props = n()) |>
  pull(props)

stat_1925 <- stat_hetero[1]/(stat_hetero[1] + stat_hetero[2])
stat_1950 <- stat_hetero[3]/(stat_hetero[3] + stat_hetero[4])
stat_1975 <- stat_hetero[5]/(stat_hetero[5] + stat_hetero[6])
stat_2000 <- stat_hetero[7]/(stat_hetero[7] + stat_hetero[8])

n_1 <- stat_hetero[1] + stat_hetero[2]
n_2 <- stat_hetero[3] + stat_hetero[4]
n_3 <- stat_hetero[5] + stat_hetero[6]
n_4 <- stat_hetero[7] + stat_hetero[8]
```

###### Pre-1950 to 1975 Proportions

```{r}

obs_stat_1925_50 <- stat_1925 - stat_1950

p_pool_1 <- (stat_hetero[1] + stat_hetero[3]) / 106

p_pool_1

```
$\hat{p_{pool_1}} * n_1 > 10$? No 

$\hat{p_{pool}} * n_2 > 10$? Yes

$1 - \hat{p_{pool}} * n_1 > 10$? Yes

$1 - \hat{p_{pool}} * n_2 > 10$? Yes

```{r}
se_1 <- sqrt(p_pool_1*(1-p_pool_1)*((1/19) + (1/87)))

zscore_1 <- obs_stat_1925_50 / se_1

2*pnorm(zscore_1, lower.tail = FALSE)
```

The proportion of movies with age gaps less than 15 years to movies with age gaps over 15 years increased from the era spanning pre-1950 to the era spanning 1950-1975.

###### 1950 to 2000 Proportions

```{r}

obs_stat_1950_75 <- stat_1950 - stat_1975

p_pool_2 <- (stat_hetero[3] + stat_hetero[5]) / 369

p_pool_2

```
$\hat{p_{pool_2}} * n_2 > 10$? Yes

$\hat{p_{pool_2}} * n_3 > 10$? Yes

$1 - \hat{p_{pool_2}} * n_2 > 10$? Yes

$1 - \hat{p_{pool_2}} * n_3 > 10$? Yes

```{r}
se_2 <- sqrt(p_pool_2*(1-p_pool_2)*((1/87) + (1/282)))

zscore_2 <- obs_stat_1950_75 / se_2

2*pnorm(zscore_2, lower.tail = FALSE)
```

The proportion of movies with age gaps less than 15 years to movies with age gaps over 15 years increased from the era spanning 1950-1975 to the era spanning 1975-2000.

###### 1975 to post-2000 Proportions
```{r}

obs_stat_1975_00 <- stat_1975 - stat_2000

p_pool_3 <- (stat_hetero[5] + stat_hetero[7]) / 1026

p_pool_3
```
$\hat{p_{pool_3}} * n_3 > 10$? Yes

$\hat{p_{pool_3}} * n_4 > 10$? Yes

$1 - \hat{p_{pool_3}} * n_3 > 10$? Yes

$1 - \hat{p_{pool_3}} * n_4 > 10$? Yes

```{r}
se_3 <- sqrt(p_pool_3*(1-p_pool_3)*((1/282) + (1/744)))

zscore_3 <- obs_stat_1975_00 / se_2

2*pnorm(zscore_3, lower.tail = FALSE)
```

The proportion of movies with age gaps less than 15 years to movies with age gaps over 15 years increased from the era spanning 1975-2000 to the post-2000 era.

###### Proportion Analysis

From era to era we have found there to consistently be a change in the proportion of large to small age gaps. Each era has shown to have a larger proportion of films with small age gaps than the era that preceded it.

#### Same-Sex Couples

```{r}
#| label: agegap-samesex

onlygaps_samesex <- agegaps_samesex |>
  filter(age_difference != 0) |>
  mutate(older_partner = if_else(actor_1_age > actor_2_age & 
                                   character_1_gender == "man", 
                                 "Gay", "Lesbian"))

onlygaps_samesex |>
  ggplot(aes(x = release_year, y = age_difference, color = older_partner)) +
  geom_point(alpha = .5) +
  geom_smooth(method = lm, se = FALSE, color = "#740C9A") +
  scale_color_manual(values = c("Gay" = "#21B0FF", "Lesbian" = "#FF218C")) +
  geom_smooth(method = lm, se = FALSE) +
  labs(title = "Age Gaps in Hollywood Films Over the Years", 
       x = "Movie Release Year",
       y = "Age Gap In Years",
       color = "Relationship Type")
```

Unlike the data on heterosexual couples, overtime the age gaps shown in films depicting same sex couples has increased.

### Conclusion

-   As the release dates of Hollywood films become more modern, the age difference between actors whose characters are in relationships has decreased.
-   As films become more modern, the proportion of films with age gaps of over 15 years has also consistently decreased.
-   It is significantly more common for the older partner in couples with an age gap to be male.
