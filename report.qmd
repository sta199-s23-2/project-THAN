---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

### Data Introduction:


```{r}
#| label: load-data-3

library(tidyverse)
Agegaps <- read.csv(file = 'data/age_gaps.csv')
glimpse(Agegaps)

```

This data comes from the Tidy Tuesday repositories on GitHub via the site "Data is Plural."

The dataset, *Hollywood Age Gap*, was compiled by Lynn Fisher andexplores the age difference between actors playing couples in Hollywood movies which demonstrates the male-female power dynamic in the movie industry.

*Hollywood Age Gap* has information from upwards of 630 movies, sampled from films from 1935 to 2022, the dataset was most recently updated on February 25th, 2023.

The dataset, while mostly compiled by Lynn Fisher, is open source and in turn anyone can submit data to the dataset for consideration contingent on three rules:

1.  The actors are atleast 17 years old
2.  The actors are actually love interests in the film
3.  The characters can not be animated

Observations of the data set list the movie name, director, release year, and then the age difference before having columns for what number couple each one is (only matters if there are multiple in the movie), their names, their characters' names, their birth dates, and then their ages.

### Research Question:

**Does the age difference of actors in movies decrease as the release date becomes more modern?**

Our research will provide concrete data on whether the uncomfortable age gaps between male and female romantic interests in movies has actually been waning over time. This will tell us if criticism within the industry and from viewers has actually been effective in making a change in this issue.

Some other things to explore would be the trends of specific actors/actresses that may have experienced both sides of the age gaps, as well as how this trend exists in movies with multiple couples. As well as looking at whether the male or female member of the couples tends to be older, and whether this trend has shifted over time.

### Methodology

We predict that overtime the age gaps between couples will lessen due to the criticism of these age gaps within the film industry. Based on a first look at the data, we can infer that this hypothesis is true.

Since same-sex couples have only begun to be shown in film in the last couple decades, we plan to filter the data set so that it only contains information about movies with heterosexual couples.

We will then plot the age difference in movies over time via a scatter-plot with all of the movies. We can then draw a best fit line to see the trend of age-gaps as time has elapsed. We will also color the age differences based on whether the man or woman in the relationship was older.

### Results

```{r}
#|label: remove-same-sex

Agegaps_updated <- Agegaps |>
  filter(character_1_gender != character_2_gender)
```

```{r}
#| label: age-gap-point

Agegaps_updated <- Agegaps_updated |>
  mutate(older_partner = if_else(actor_1_age > actor_2_age & 
                                   character_1_gender == "man", 
                                 "Male", 
                                 "Female"))

Agegaps_updated |>
  ggplot(aes(x = release_year, y = age_difference, color = older_partner)) +
  geom_point(alpha = .5) +
  geom_smooth(method = lm, se = FALSE, color = "#740C9A") +
  scale_color_manual(values = c("Female" = "#FF218C", "Male" = "#21B0FF")) +
  geom_smooth(method = lm, se = FALSE) +
  labs(title = "Age Gaps in Hollywood Films Over the Years", 
       x = "Movie Release Year",
       y = "Age Gap In Years",
       color = "Older Partner Gender")
```

```{r}
#| label: age-gap-histo-decades

Agegaps_updated <- Agegaps_updated |>
  mutate(age_gap_cat = if_else(age_difference <= 15, 
                               "Age Gap of 15 Years or Less", 
                               "Age Gap Over 15 Years")) |>
  mutate(age_gap_cat = fct_relevel(age_gap_cat, c("Age Gap Over 15 Years",
                                                  "Age Gap of 15 Years or Less"))) |>
  arrange(age_gap_cat)


Agegaps_updated <- Agegaps_updated |>
  mutate(decades = if_else(release_year >= 1931 & release_year <= 1940, 
                                 "1930s",
                          if_else(release_year >= 1941 & release_year <= 1950, 
                                  "1940s",
                          if_else(release_year >= 1951 & release_year <= 1960, 
                                  "1950s",
                          if_else(release_year >= 1961 & release_year <= 1970, 
                                  "1960s",
                          if_else(release_year >= 1971 & release_year <= 1980, 
                                  "1970s",
                          if_else(release_year >= 1981 & release_year <= 1990, 
                                  "1980s",
                          if_else(release_year >= 1991 & release_year <= 2000, 
                                  "1990s",
                          if_else(release_year >= 2001 & release_year <= 2010, 
                                  "2000s",
                          if_else(release_year >= 2011 & release_year <= 2020, 
                                  "2010s", "2020s"))))))))))


Agegaps_updated |>
  ggplot(aes(x = decades, fill = age_gap_cat)) +
  geom_bar(position = "fill", color = "black") +
  scale_fill_manual("Age Gap Category", values = c("Age Gap Over 15 Years" = "#EB5F5E",
                                         "Age Gap of 15 Years or Less" = "#BC5090")) +
  labs(title = "The Decrease of Age Gaps of More Than 15 Years Over Time",
       x = "Decade of Film Release",
       y = "Proportion of Films")

```

```{r}
#| label: age-gap-histo-25years

Agegaps_updated <- Agegaps_updated |>
  mutate(era = if_else(release_year >= 1930 & release_year < 1950, 
                                 "pre-1950s",
                          if_else(release_year >= 1951 & release_year < 1975, 
                                  "1950 to 1975",
                          if_else(release_year >= 1975 & release_year < 2000, 
                                  "1975 to 2000", "2000 to 2025")))) |>
  mutate(era = fct_relevel(era, c("pre-1950s",
                                          "1950 to 1975",
                                          "1975 to 2000",
                                          "2000 to 2025"))) |>
  arrange(era)


Agegaps_updated |>
  ggplot(aes(x = era, fill = age_gap_cat)) +
  geom_bar(position = "fill", color = "black") +
  scale_fill_manual("Age Gap Category", values = c("Age Gap Over 15 Years" = "#EB5F5E",
                                         "Age Gap of 15 Years or Less" = "#BC5090")) +
  labs(title = "The Decrease of Age Gaps of More Than 15 Years Over 25 Year Periods",
       x = "25 Year Film Release Era",
       y = "Proportion of Films")
```

The bar chart above simplifies the previous bar chart by combining decades into chunks of 25 years. The plot clearly shows that as over each 25 year period, the proportion of films containing age gaps of over 15 years decreases. From pre-1950, with over 50% of films having large age gaps over of over 15 years to 2000-2025 where less than 25% of films contain a couple with an age gap of over 15 years.
